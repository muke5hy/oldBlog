<!DOCTYPE html>
<html lang="en">
<head>
        <title>Changing mysqldata directory ubuntu and apparmor</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css" />
        <link rel="stylesheet" href="http://www.mukeshyadav.com/theme/css/main.css" />
        <link href="http://www.mukeshyadav.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Learning the hard way! Full Atom Feed" />
        <link href="http://www.mukeshyadav.com/feeds/category/notes.atom.xml" type="application/atom+xml" rel="alternate" title="Learning the hard way! Categories Atom Feed" />
</head>
<body>
    <script>
      if (window.location.href.indexOf('ingenioustechie.com') > 0) {
        window.location.href = window.location.href.replace('ingenioustechie.com', "mukeshyadav.com")
      }
    </script>

    <div class="main-nav-container">

        <div class="pure-g">
            <div class="pure-u-1 pure-u-lg-2-3">
                <div class="main-nav">
                    <ul class="main-nav-list">
                        <li class="main-nav-item"><a href="http://www.mukeshyadav.com/" class="pure-menu-link">Learning the hard way!</a></li>
                        <li class="main-nav-item"><a href="https://twitter.com/muke5hy" class="pure-menu-link">Twitter</a></li>
                        <li class="main-nav-item"><a href="https://www.dropbox.com/s/6paxwgajkke84ie/MukeshYadav.pdf" class="pure-menu-link">RESUME</a></li>

                    </ul>
                </div>
             </div>

             <div class="pure-u-1 pure-u-lg-1-3"></div>
        </div>

    </div>


<div class="page-container">
    <div class="entry-content">
        <div class="post-meta pure-g">
            <div class="pure-u-3-4 meta-data">
                <a href="http://www.mukeshyadav.com/category/notes/index.html" class="category">notes</a><br />

                <a class="author" href="http://www.mukeshyadav.com/author/mukesh.html">Mukesh</a>
                &mdash; <abbr title="2015-06-20T12:00:58+05:30">Sat 20 June 2015</abbr>
            </div>
        </div>
    </div>

    <div class="article-header-container">
        <div class="background-image-container">

            <div class="background-image-small">
                <div class="title-container">
                    <h1>Changing mysqldata directory ubuntu and apparmor</h1>
                </div>
            </div>
        </div>
    </div>

    <div class="entry-content">
        <p>After a bit of googling and hair-pulling, I realized that if I just changed the datadir directive in my.cnf will cause mysql start to fail on Ubuntu. The other thing is to add permissions to apparmor for mysql to access the new data directories.</p>
<p>Steps
1. sudo vi /etc/apparmor.d/usr.sbin.mysqld
2. Add
/newdir/ r,
/newdir/** rwk,
3. sudo /etc/init.d/apparmor restart
4. sudo /etc/init.d/mysql restart</p>
<p>If that still does not work, check the nix permissions to be sure mysql is owner and group for the new directory recursively.
chown -R mysql:mysql “new datadir path”</p>
    </div>

    <footer>
        <div class="tags">
            <a href="http://www.mukeshyadav.com/tag/note/index.html">note</a>
        </div>
        <div class="pure-g post-footer">
            <div class="pure-u-1 pure-u-md-1-2">
                <div class="pure-g poster-info">
                    <div class="pure-u-3-4">
                        <h3 class="author-name"><a href="http://www.mukeshyadav.com/author/mukesh.html">Mukesh</a></h3>
                        <p class="author-description">
                        </p>
                    </div>
                </div>
            </div>



        </div>


    </footer>

    <div class="entry-content">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_shortname = 'ingenioustechie';
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
    </div>

</div>


</body>
</html>